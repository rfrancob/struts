
<!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE- 2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License. 
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <LINK type="text/css" rel="stylesheet" href="http://struts.apache.org/style/default.css">
    <STYLE type="text/css">
      .dp-highlighter {
        width:95% !important;
      }
    </STYLE>
    <STYLE type="text/css">
      .footer {
        background-image:      url('https://cwiki.apache.org/confluence/images/border/border_bottom.gif');
        background-repeat:     repeat-x;
        background-position:   left top;
        padding-top:           4px;
        color:                 #666;
      }
    </STYLE>
    <SCRIPT type="text/javascript" language="javascript">
      var hide = null;
      var show = null;
      var children = null;

      function init() {
        /* Search form initialization */
        var form = document.forms['search'];
        if (form != null) {
          form.elements['domains'].value = location.hostname;
          form.elements['sitesearch'].value = location.hostname;
        }

        /* Children initialization */
        hide = document.getElementById('hide');
        show = document.getElementById('show');
        children = document.all != null ?
                   document.all['children'] :
                   document.getElementById('children');
        if (children != null) {
          children.style.display = 'none';
          show.style.display = 'inline';
          hide.style.display = 'none';
        }
      }

      function showChildren() {
        children.style.display = 'block';
        show.style.display = 'none';
        hide.style.display = 'inline';
      }

      function hideChildren() {
        children.style.display = 'none';
        show.style.display = 'inline';
        hide.style.display = 'none';
      }
    </SCRIPT>
    <TITLE>Request Parameter to Action Object Mapping Plugin for Insecure Direct Object References</TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">
    <TABLE border="0" cellpadding="2" cellspacing="0" width="100%">
      <TR class="topBar">
        <TD align="left" valign="middle" class="topBarDiv" align="left" nowrap="">
          &nbsp;<A href="home.html" title="Apache Struts 2 Plugin Registry">Apache Struts 2 Plugin Registry</A>&nbsp;&gt;&nbsp;<A href="" title="Request Parameter to Action Object Mapping Plugin for Insecure Direct Object References">Request Parameter to Action Object Mapping Plugin for Insecure Direct Object References</A>
        </TD>
        <TD align="right" valign="middle" nowrap="">
          <FORM name="search" action="http://www.google.com/search" method="get">
            <INPUT type="hidden" name="ie" value="UTF-8">
            <INPUT type="hidden" name="oe" value="UTF-8">
            <INPUT type="hidden" name="domains" value="">
            <INPUT type="hidden" name="sitesearch" value="">
            <INPUT type="text" name="q" maxlength="255" value="">        
            <INPUT type="submit" name="btnG" value="Google Search">
          </FORM>
        </TD>
      </TR> 
    </TABLE>

    <DIV id="PageContent">
      <DIV class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="/wiki/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <DIV style="margin: 0px 10px 0px 10px" class="smalltext">Apache Struts 2 Plugin Registry</DIV>
        <DIV style="margin: 0px 10px 8px 10px" class="pagetitle">Request Parameter to Action Object Mapping Plugin for Insecure Direct Object References</DIV>

        <DIV class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
          <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=24189116">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/notep_16.gif" height="16" width="16" border="0" align="absmiddle" title="Edit Page"></A>
            <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=24189116">Edit Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=S2PLUGINS">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/browse_space.gif" height="16" width="16" border="0" align="absmiddle" title="Browse Space"></A>
            <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=S2PLUGINS">Browse Space</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=S2PLUGINS&fromPageId=24189116">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_page_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add Page"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=S2PLUGINS&fromPageId=24189116">Add Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=S2PLUGINS&fromPageId=24189116">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add News"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=S2PLUGINS&fromPageId=24189116">Add News</A>
        </DIV>
      </DIV>
      <DIV class="pagesubheading" style="margin: 0px 10px 0px 10px;">
        #editReport()
      </DIV>

      <DIV class="pagecontent">
        <DIV class="wiki-content">
          <DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Name </TH>
<TD class="confluenceTd"> JSP Parameter to Action Object Mapping (Security) Plugin </TD>
</TR>
<TR>
<TH class="confluenceTh"> Publisher </TH>
<TD class="confluenceTd"> <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=S2PLUGINS&title=Datta%20kudale&linkCreation=true&fromPageId=24189116" class="createlink">Datta kudale</A> </TD>
</TR>
<TR>
<TH class="confluenceTh"> License </TH>
<TD class="confluenceTd"> Apache Software Foundation (ASF) </TD>
</TR>
<TR>
<TH class="confluenceTh"> Version </TH>
<TD class="confluenceTd"> 0.1-ALPHA </TD>
</TR>
<TR>
<TH class="confluenceTh"> Compatibility </TH>
<TD class="confluenceTd"> Struts 2.0.2&#43; </TD>
</TR>
<TR>
<TH class="confluenceTh"> Homepage </TH>
<TD class="confluenceTd"> <A href="http://code.google.com/p/request-parameter-plugin-for-insecure-direct-object-reference/" class="external-link" rel="nofollow">http://code.google.com/p/request-parameter-plugin-for-insecure-direct-object-reference/</A> </TD>
</TR>
<TR>
<TH class="confluenceTh"> Download </TH>
<TD class="confluenceTd"> <A href="http://code.google.com/p/request-parameter-plugin-for-insecure-direct-object-reference/downloads/list" class="external-link" rel="nofollow">http://code.google.com/p/request-parameter-plugin-for-insecure-direct-object-reference/downloads/list</A> </TD>
</TR>
</TBODY></TABLE>
</DIV>


<P><STYLE type="text/css">
    /*             styles for the star rater                */
    .star-rating{
        list-style:none;
        margin: 0px;
        padding:0px;
        width: 100px;
        height: 20px;
        position: relative;
        background: url(https://cwiki.apache.org/confluence/download/resources/adaptavist.confluence.rate:rate/gfx/dynamic/star_rating.gif) top left repeat-x;
    }
    .star-rating li{
        padding:0px;
        margin:0px;
        /*\*/
        float: left;
        /* */
    }
    .star-rating li a{
        display:block;
        width:20px;
        height: 20px;
        text-decoration: none;
        text-indent: -9000px;
        z-index: 20;
        position: absolute;
        padding: 0px;
    }
    .star-rating li a:hover{
        background: url(https://cwiki.apache.org/confluence/download/resources/adaptavist.confluence.rate:rate/gfx/dynamic/star_rating.gif) left bottom;
        z-index: 1;
        left: 0px;
    }
    .star-rating a.one-star{
        left: 0px;
    }
    .star-rating a.one-star:hover{
        width:20px;
    }
    .star-rating a.two-stars{
        left:20px;
    }
    .star-rating a.two-stars:hover{
        width: 40px;
    }
    .star-rating a.three-stars:hover{
        width: 60px;
    }
    .star-rating a.three-stars{
        left: 40px;
    }
    .star-rating a.four-stars{
        left: 60px;
    }
    .star-rating a.four-stars:hover{
        width: 80px;
    }
    .star-rating a.five-stars{
        left: 80px;
    }
    .star-rating a.five-stars:hover{
        width: 100px;
    }
</STYLE>
<SCRIPT type="text/javascript">
    document.Rate = {
        rateURL: "/confluence/plugins/rate/rating.action?contentId=24189116",
        clearURL: "/confluence/plugins/rate/clear.action?contentId=24189116",
        backURL: "/confluence/plugins/rate/back.action?contentId=24189116",
        unrateURL: "/confluence/plugins/rate/undo.action?contentId=24189116",
        rateKey: false, comms: [], req: false,
        doAJAX: function (url,rateKey) {
            var commsObj = false;
            // Build the AJAX object
            if (window.XMLHttpRequest) {
                commsObj = new XMLHttpRequest();
            } else if (window.ActiveXObject) {
                commsObj = new ActiveXObject("Microsoft.XMLHTTP");
            }
            // Check it worked
            if (!commsObj) return false;
            // Store the AJAX object
            var idx = document.Rate.comms.length;
            document.Rate.comms[idx] = commsObj;
            // Setup the object
            commsObj.open("GET", url, true);
            eval("commsObj.onreadystatechange = function () { "+
                 "if (document.Rate.comms["+ idx +"].readyState == 4) { "+
                 "if (document.Rate.comms["+ idx +"].status == 200) { "+
                 "document.getElementById('rate"+ rateKey +"').innerHTML = document.Rate.comms["+ idx +"].responseText; "+
                 "document.Rate.comms["+ idx +"] = false; "+
                 "} "+
                 "} "+
                 "} "
            );
            commsObj.send(null);
            return true;
        },
        doAction: function (rateKey, url, rating) {
            // set the cookie
            if (rating > 0) {
                var today = new Date();
                var expire = new Date();
                expire.setTime(today.getTime() + 3600000*24*7*52);
                var cookieStr = document.getElementById("rate"+ rateKey +".cookieName").innerHTML +"="+
                                rating +";expires="+expire.toGMTString();
                document.cookie = cookieStr;
            } else if (rating < 0) {
                var cookieStr = document.getElementById("rate"+ rateKey +".cookieName").innerHTML +"="+
                                ";expires=Thu, 01-Jan-1970 00:00:01 GMT";
                document.cookie = cookieStr;
            }
            // Cycle through and clear out dead requests
            var result = document.Rate.doAJAX(url, rateKey);
            if (!result) {
                alert("There was a problem with executing your request.");
                return false;
            }
        }
    };
</SCRIPT>
<DIV id="rateJspParameterObjectMappingPlugin">
<DIV style="visibility:hidden; display:none;" id="rateJspParameterObjectMappingPlugin.cookieName">rate-24189116-91134</DIV>
<TABLE class="confluenceTable">
    <TBODY>
        <TR>
            <TD class="confluenceTd" height="25">Rating?</TD>
            <TH class="confluenceTh" height="25" align="center" valign="middle">
                <UL class="star-rating">
                  <LI><A href="javascript:document.Rate.doAction('JspParameterObjectMappingPlugin',document.Rate.rateURL+'&rateDir=dynamic&rateKey=JspParameterObjectMappingPlugin&rateTitle=Rating&rating=1',1)" title="Rate this 1 out of 5" class="one-star">1</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('JspParameterObjectMappingPlugin',document.Rate.rateURL+'&rateDir=dynamic&rateKey=JspParameterObjectMappingPlugin&rateTitle=Rating&rating=2',2)" title="Rate this 2 out of 5" class="two-stars">2</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('JspParameterObjectMappingPlugin',document.Rate.rateURL+'&rateDir=dynamic&rateKey=JspParameterObjectMappingPlugin&rateTitle=Rating&rating=3',3)" title="Rate this 3 out of 5" class="three-stars">3</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('JspParameterObjectMappingPlugin',document.Rate.rateURL+'&rateDir=dynamic&rateKey=JspParameterObjectMappingPlugin&rateTitle=Rating&rating=4',4)" title="Rate this 4 out of 5" class="four-stars">4</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('JspParameterObjectMappingPlugin',document.Rate.rateURL+'&rateDir=dynamic&rateKey=JspParameterObjectMappingPlugin&rateTitle=Rating&rating=5',5)" title="Rate this 5 out of 5" class="five-stars">5</A></LI>
                </UL>
            </TH>
            <TD class="confluenceTd" height="25" align="center" valign="middle">
                <A href="javascript:document.Rate.doAction('JspParameterObjectMappingPlugin',document.Rate.rateURL+'&rateDir=dynamic&rateKey=JspParameterObjectMappingPlugin&rateTitle=Rating&rating=0',false)" title="Display Results (16)"><IMG class="emoticon" src="https://cwiki.apache.org/confluence/download/resources/adaptavist.confluence.rate:rate/gfx/dynamic/chart.gif" alt="" border="0"></A>
            </TD>
        </TR>
    </TBODY>
</TABLE>
 </DIV> </P>

<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Overview"></A>Overview</H2>

<P>JSP Parameter to Action Object Mapping (Security) Plugin does this great thing.  Here is also a short overview of what it does and why a developer would want to use it.</P>

<P>Many applications expose their internal object references to users. Attackers use parameter tampering to change references and violate the intended but unenforced access control policy. Frequently, these references point to file systems and databases, but any exposed application construct could be vulnerable.</P>

<P>The best protection is to avoid exposing direct object references to users by using an index, indirect reference map, or other indirect method that is easy to validate. If a direct object reference must be used, ensure that the user is authorized before using it.</P>

<UL>
	<LI>Avoid exposing your private object references to users whenever possible, such as primary keys or filenames</LI>
	<LI>Validate any private object references extensively with an &quot;accept known good&quot; approach</LI>
	<LI>Verify authorization to all referenced objects</LI>
</UL>


<P>So to avoid internal object implementation to end user, this plugin can be used.</P>

<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Threat Agents </TH>
<TH class="confluenceTh"> Attack Vectors </TH>
<TH class="confluenceTh"> Security Weakness </TH>
<TH class="confluenceTh"> Technical Impacts </TH>
<TH class="confluenceTh"> Business Impacts </TH>
</TR>
<TR>
<TH class="confluenceTh"> &#95;____&#95; </TH>
<TH class="confluenceTh"> <FONT color="#ff0000">Exploitability EASY</FONT> </TH>
<TH class="confluenceTh"> Prevalence COMMON <FONT color="#ff0000">Detectability EASY</FONT> </TH>
<TH class="confluenceTh"> Impact MODERATE </TH>
<TH class="confluenceTh"> &#95;____&#95; </TH>
</TR>
<TR>
<TD class="confluenceTd"> Consider the types of users of your system. Do any users have only partial access to certain types of system data? </TD>
<TD class="confluenceTd"> Attacker, who is an authorized system user, simply changes a parameter value that directly refers to a system object to another object the user isn&rsquo;t authorized for. Is access granted? </TD>
<TD class="confluenceTd"> Applications frequently use the actual name or key of an object when generating web pages. Applications don&rsquo;t always verify the user is authorized for the target object. This results in an insecure direct object reference flaw. Testers can easily manipulate parameter values to detect such flaws and code analysis quickly shows whether authorization is properly verified. </TD>
<TD class="confluenceTd"> Such flaws can compromise all the data that can be referenced by the parameter. Unless the name space is sparse, it&rsquo;s easy for an attacker to access all available data of that type. </TD>
<TD class="confluenceTd"> Consider the business value of the exposed data. Also consider the business impact of public exposure of the vulnerability. </TD>
</TR>
</TBODY></TABLE>
</DIV>



<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Features"></A>Features</H2>

<UL>
	<LI>Web Security constraint handled in this plugin for Direct Object reference attack</LI>
</UL>


<UL>
	<LI>Single HTML request parameter can be set in Action Object in multiple sub class object</LI>
</UL>





<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Usage"></A>Usage</H2>

<P>Instructions how to use your plugin.</P>

<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Example"></A>Example</H2>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
This is a quick example of JSP Parameter to Action <SPAN class="code-object">Object</SPAN> Mapping Plugin in action
</PRE>
</DIV></DIV>

<P>You could also include screenshots by attaching the images to this page</P>


<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Settings"></A>Settings</H2>

<P>The following settings can be customized.  See the <A href="http://cwiki.apache.org/confluence/display/WW/Configuration%20Files" class="external-link" rel="nofollow">developer guide</A>.</P>

<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Setting </TH>
<TH class="confluenceTh"> Description </TH>
<TH class="confluenceTh"> Default </TH>
<TH class="confluenceTh"> Possible Values </TH>
</TR>
</TBODY></TABLE>
</DIV>



<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Installation"></A>Installation</H2>

<P>This plugin can be installed by copying the plugin jar into your application's <TT>/WEB-INF/lib</TT> directory.  No other files need to be copied or created.</P>


<UL>
	<LI>Add new xml file in current Action class with filename like<BR>
<FONT color="#0000ff"><B>&quot;&lt;ActionName&gt;-jspObjectMapping.xml&quot;</B></FONT></LI>
</UL>


<UL>
	<LI>XML File format given below
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
       *DTD format*
</PRE>
</DIV></DIV></LI>
	<LI><DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;\!DOCTYPE mapping \[
&lt;\!ELEMENT mapping    (requestParameter)&gt;
&lt;\!ELEMENT requestParameter      (objectMapping)&gt;
&lt;\!ELEMENT objectMapping    (property)&gt;
&lt;\!ELEMENT property (#PCDATA)&gt;
\]&gt;
</PRE>
</DIV></DIV></LI>
	<LI><DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
       *XML Format*
</PRE>
</DIV></DIV></LI>
	<LI><DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;mapping&gt;
&lt;requestParameter name=<SPAN class="code-quote">&quot;userName&quot;</SPAN>&gt;
&lt;objectMapping&gt;
&lt;property&gt;user.userName&lt;/property&gt;
&lt;/objectMapping&gt;
&lt;/requestParameter&gt;
&lt;requestParameter name=<SPAN class="code-quote">&quot;password&quot;</SPAN>&gt;
&lt;objectMapping&gt;
&lt;property&gt;user.password&lt;/property&gt;
&lt;/objectMapping&gt;
&lt;/requestParameter&gt;
&lt;/mapping&gt;

</PRE>
</DIV></DIV></LI>
</UL>


<UL>
	<LI>Extends package with name <FONT color="#0000ff"><B>&quot;jsp-parameter-object-mapping&quot;</B></FONT></LI>
</UL>


<UL>
	<LI>Add interceptor on interceptor stack
<H5><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-%3Cinterceptorrefname%3D%22parameterToActionObjectMapping%22%2F%3E"></A>&lt;interceptor-ref name=&quot;parameterToActionObjectMapping&quot; /&gt;</H5></LI>
</UL>





<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-Resources"></A>Resources</H2>

<UL>
	<LI>Links to any other documentation or related products</LI>
</UL>


<P><A href="http://www.owasp.org/index.php/Top_10_2010-A4-Insecure_Direct_Object_References" class="external-link" rel="nofollow">http://www.owasp.org/index.php/Top_10_2010-A4-Insecure_Direct_Object_References</A></P>




<H2><A name="RequestParametertoActionObjectMappingPluginforInsecureDirectObjectReferences-VersionHistory"></A>Version History</H2>

<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Version </TH>
<TH class="confluenceTh"> Date </TH>
<TH class="confluenceTh"> Author </TH>
<TH class="confluenceTh"> Notes </TH>
</TR>
<TR>
<TD class="confluenceTd"> 1.0 </TD>
<TD class="confluenceTd"> Dec 20, 2006 </TD>
<TD class="confluenceTd"> <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=S2PLUGINS&title=Datta%20kudale&linkCreation=true&fromPageId=24189116" class="createlink">Datta kudale</A> </TD>
<TD class="confluenceTd"> Initial release </TD>
</TR>
</TBODY></TABLE>
</DIV>

        </DIV>

        
      </DIV>
    </DIV>
    <DIV class="footer">
      Generated by
      <A href="http://www.atlassian.com/confluence/">Atlassian Confluence</A> (Version: 3.2 Build: 1810 Mar 16, 2010)
      <A href="http://could.it/autoexport/">Auto Export Plugin</A> (Version: 1.0.0-dkulp)
    </DIV>
  </BODY>
</HTML>