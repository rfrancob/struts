
<!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE- 2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License. 
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <LINK type="text/css" rel="stylesheet" href="http://struts.apache.org/style/default.css">
    <STYLE type="text/css">
      .dp-highlighter {
        width:95% !important;
      }
    </STYLE>
    <STYLE type="text/css">
      .footer {
        background-image:      url('https://cwiki.apache.org/confluence/images/border/border_bottom.gif');
        background-repeat:     repeat-x;
        background-position:   left top;
        padding-top:           4px;
        color:                 #666;
      }
    </STYLE>
    <SCRIPT type="text/javascript" language="javascript">
      var hide = null;
      var show = null;
      var children = null;

      function init() {
        /* Search form initialization */
        var form = document.forms['search'];
        if (form != null) {
          form.elements['domains'].value = location.hostname;
          form.elements['sitesearch'].value = location.hostname;
        }

        /* Children initialization */
        hide = document.getElementById('hide');
        show = document.getElementById('show');
        children = document.all != null ?
                   document.all['children'] :
                   document.getElementById('children');
        if (children != null) {
          children.style.display = 'none';
          show.style.display = 'inline';
          hide.style.display = 'none';
        }
      }

      function showChildren() {
        children.style.display = 'block';
        show.style.display = 'none';
        hide.style.display = 'inline';
      }

      function hideChildren() {
        children.style.display = 'none';
        show.style.display = 'inline';
        hide.style.display = 'none';
      }
    </SCRIPT>
    <TITLE>Spring Webflow Plugin</TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">
    <TABLE border="0" cellpadding="2" cellspacing="0" width="100%">
      <TR class="topBar">
        <TD align="left" valign="middle" class="topBarDiv" align="left" nowrap="">
          &nbsp;<A href="home.html" title="Apache Struts 2 Plugin Registry">Apache Struts 2 Plugin Registry</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="" title="Spring Webflow Plugin">Spring Webflow Plugin</A>
        </TD>
        <TD align="right" valign="middle" nowrap="">
          <FORM name="search" action="http://www.google.com/search" method="get">
            <INPUT type="hidden" name="ie" value="UTF-8">
            <INPUT type="hidden" name="oe" value="UTF-8">
            <INPUT type="hidden" name="domains" value="">
            <INPUT type="hidden" name="sitesearch" value="">
            <INPUT type="text" name="q" maxlength="255" value="">        
            <INPUT type="submit" name="btnG" value="Google Search">
          </FORM>
        </TD>
      </TR> 
    </TABLE>

    <DIV id="PageContent">
      <DIV class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="/wiki/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <DIV style="margin: 0px 10px 0px 10px" class="smalltext">Apache Struts 2 Plugin Registry</DIV>
        <DIV style="margin: 0px 10px 8px 10px" class="pagetitle">Spring Webflow Plugin</DIV>

        <DIV class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
          <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=33762">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/notep_16.gif" height="16" width="16" border="0" align="absmiddle" title="Edit Page"></A>
            <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=33762">Edit Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=S2PLUGINS">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/browse_space.gif" height="16" width="16" border="0" align="absmiddle" title="Browse Space"></A>
            <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=S2PLUGINS">Browse Space</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=S2PLUGINS&fromPageId=33762">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_page_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add Page"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=S2PLUGINS&fromPageId=33762">Add Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=S2PLUGINS&fromPageId=33762">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add News"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=S2PLUGINS&fromPageId=33762">Add News</A>
        </DIV>
      </DIV>
      <DIV class="pagesubheading" style="margin: 0px 10px 0px 10px;">
        #editReport()
      </DIV>

      <DIV class="pagecontent">
        <DIV class="wiki-content">
          <DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh">Name         </TH>
<TD class="confluenceTd"> Spring Webflow Plugin </TD>
</TR>
<TR>
<TH class="confluenceTh">Publisher    </TH>
<TD class="confluenceTd"> <A href="https://cwiki.apache.org/confluence/users/viewuserprofile.action?username=schneidh@gmail.com" class="confluence-userlink username:schneidh@gmail.com">Tom Schneider</A> </TD>
</TR>
<TR>
<TH class="confluenceTh">License      </TH>
<TD class="confluenceTd"> Open Source (ASL2) </TD>
</TR>
<TR>
<TH class="confluenceTh">Version      </TH>
<TD class="confluenceTd"> 1.0.3 Production </TD>
</TR>
<TR>
<TH class="confluenceTh">Compatibility</TH>
<TD class="confluenceTd"> Struts 2.0.6+ </TD>
</TR>
<TR>
<TH class="confluenceTh">Homepage     </TH>
<TD class="confluenceTd"> <A href="http://code.google.com/p/struts2webflow/" class="external-link" rel="nofollow">http://code.google.com/p/struts2webflow/</A> </TD>
</TR>
<TR>
<TH class="confluenceTh">Download     </TH>
<TD class="confluenceTd"> <A href="http://code.google.com/p/struts2webflow/downloads/list" class="external-link" rel="nofollow">http://code.google.com/p/struts2webflow/downloads/list</A> </TD>
</TR>
</TBODY></TABLE>
</DIV>


<P><DIV id="rate33762">
<DIV style="visibility:hidden; display:none;" id="rate33762.cookieName">rate-33762-85020</DIV>
<TABLE class="confluenceTable">
    <TBODY>
        <TR>
            <TD class="confluenceTd" height="25">Rating?</TD>
            <TH class="confluenceTh" height="25" align="center" valign="middle">
                <UL class="star-rating">
                  <LI><A href="javascript:document.Rate.doAction('33762',document.Rate.rateURL+'&rateDir=dynamic&rateKey=33762&rateTitle=Rating&rating=1',1)" title="Rate this 1 out of 5" class="one-star">1</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('33762',document.Rate.rateURL+'&rateDir=dynamic&rateKey=33762&rateTitle=Rating&rating=2',2)" title="Rate this 2 out of 5" class="two-stars">2</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('33762',document.Rate.rateURL+'&rateDir=dynamic&rateKey=33762&rateTitle=Rating&rating=3',3)" title="Rate this 3 out of 5" class="three-stars">3</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('33762',document.Rate.rateURL+'&rateDir=dynamic&rateKey=33762&rateTitle=Rating&rating=4',4)" title="Rate this 4 out of 5" class="four-stars">4</A></LI>
                  <LI><A href="javascript:document.Rate.doAction('33762',document.Rate.rateURL+'&rateDir=dynamic&rateKey=33762&rateTitle=Rating&rating=5',5)" title="Rate this 5 out of 5" class="five-stars">5</A></LI>
                </UL>
            </TH>
            <TD class="confluenceTd" height="25" align="center" valign="middle">
                <A href="javascript:document.Rate.doAction('33762',document.Rate.rateURL+'&rateDir=dynamic&rateKey=33762&rateTitle=Rating&rating=0',false)" title="Display Results (7)"><IMG class="emoticon" src="https://cwiki.apache.org/confluence/download/resources/adaptavist.confluence.rate:rate/gfx/dynamic/chart.gif" alt="" border="0"></A>
            </TD>
        </TR>
    </TBODY>
</TABLE>
 </DIV> </P>

<H2><A name="SpringWebflowPlugin-Overview"></A>Overview</H2>

<P>The Spring Webflow plugin integrates <A href="http://www.springframework.org/webflow" class="external-link" rel="nofollow">Spring Webflow</A> (SWF) with Struts 2.  It allows Struts 2 to execute spring webflows and allows spring webflows to have Struts 2 actions as webflow actions. There is also a sample car insurance app that illustrates usage of the plugin.</P>

<H3><A name="SpringWebflowPlugin-Features"></A>Features</H3>

<UL>
	<LI>Allows Struts 2 to execute spring webflows</LI>
	<LI>Allows Struts 2 actions to be invoked by spring webflow.</LI>
	<LI>Includes an interceptor that injects flow scope properties into Struts 2 actions.</LI>
	<LI>Includes an annotation-based interceptor that injects flow scope properties into Struts 2 actions.</LI>
	<LI>SWF flow execution key can be managed in the session rather than as a hidden field on the client.</LI>
</UL>


<H3><A name="SpringWebflowPlugin-Requirements"></A>Requirements</H3>

<UL>
	<LI>Spring 2.0+</LI>
	<LI>Spring Webflow 1.0+</LI>
	<LI>Struts 2.0.6+</LI>
	<LI>Struts2Webflow 1.0.3+</LI>
</UL>


<H3><A name="SpringWebflowPlugin-Installation"></A>Installation</H3>

<P>See <A href="http://code.google.com/p/struts2plugin-maven-repo/" class="external-link" rel="nofollow">http://code.google.com/p/struts2plugin-maven-repo/</A> if you use maven.</P>

<P>For non-maven users, this plugin can be installed by copying the plugin jar into your application's <TT>/WEB-INF/lib</TT> directory.  </P>

<H3><A name="SpringWebflowPlugin-GettingStarted"></A>Getting Started</H3>

<H4><A name="SpringWebflowPlugin-Prerequisite"></A>Prerequisite</H4>

<P>For background information on the core Spring Webflow concepts, visit <A href="http://www.ervacon.com/products/swf/intro/" class="external-link" rel="nofollow">http://www.ervacon.com/products/swf/intro/</A>.</P>

<H4><A name="SpringWebflowPlugin-Step1Createyourflowdefinitionxml"></A>Step 1 - Create your flow definition xml</H4>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;flow xmlns=<SPAN class="code-quote">&quot;http:<SPAN class="code-comment">//www.springframework.org/schema/webflow&quot;</SPAN>
</SPAN>      xmlns:xsi=<SPAN class="code-quote">&quot;http:<SPAN class="code-comment">//www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
</SPAN>      xsi:schemaLocation=&quot;http:<SPAN class="code-comment">//www.springframework.org/schema/webflow
</SPAN>                          http:<SPAN class="code-comment">//www.springframework.org/schema/webflow/spring-webflow-1.0.xsd&quot;&gt;
</SPAN>
	&lt;start-state idref=<SPAN class="code-quote">&quot;ageEnter&quot;</SPAN> /&gt;

	&lt;view-state id=<SPAN class="code-quote">&quot;ageEnter&quot;</SPAN> view=<SPAN class="code-quote">&quot;ageEnter&quot;</SPAN>&gt;
		&lt;transition on=<SPAN class="code-quote">&quot;submit&quot;</SPAN> to=<SPAN class="code-quote">&quot;AgeSave&quot;</SPAN> /&gt;
	&lt;/view-state&gt;

	&lt;view-state id=<SPAN class="code-quote">&quot;ageEnterJSP&quot;</SPAN> view=<SPAN class="code-quote">&quot;ageEnter&quot;</SPAN>&gt;
		&lt;transition on=<SPAN class="code-quote">&quot;input&quot;</SPAN> to=<SPAN class="code-quote">&quot;enterAgeJSP&quot;</SPAN> /&gt;
		&lt;transition on=<SPAN class="code-quote">&quot;submit&quot;</SPAN> to=<SPAN class="code-quote">&quot;AgeSave&quot;</SPAN> /&gt;
	&lt;/view-state&gt;

	&lt;action-state id=<SPAN class="code-quote">&quot;AgeSave&quot;</SPAN>&gt;
		&lt;action bean=<SPAN class="code-quote">&quot;struts2FlowAdapter&quot;</SPAN>/&gt;
		&lt;transition on=<SPAN class="code-quote">&quot;input&quot;</SPAN> to=<SPAN class="code-quote">&quot;enterAgeJSP&quot;</SPAN> /&gt;
		&lt;transition on=<SPAN class="code-quote">&quot;success&quot;</SPAN> to=<SPAN class="code-quote">&quot;calcRate&quot;</SPAN> /&gt;
	&lt;/action-state&gt;

	&lt;view-state id=<SPAN class="code-quote">&quot;calcRate&quot;</SPAN> view=<SPAN class="code-quote">&quot;calcRate&quot;</SPAN>&gt;
		&lt;transition on=<SPAN class="code-quote">&quot;finish&quot;</SPAN> to=<SPAN class="code-quote">&quot;finish&quot;</SPAN> /&gt;
	&lt;/view-state&gt;

	&lt;end-state id=<SPAN class="code-quote">&quot;finish&quot;</SPAN> view=<SPAN class="code-quote">&quot;finish&quot;</SPAN>/&gt;
&lt;/flow&gt;
</PRE>
</DIV></DIV>

<H4><A name="SpringWebflowPlugin-Step2ConfigureSpring%27sapplicationContext.xml"></A>Step 2 - Configure Spring's applicationContext.xml</H4>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;beans xmlns=<SPAN class="code-quote">&quot;http:<SPAN class="code-comment">//www.springframework.org/schema/beans&quot;</SPAN>
</SPAN>       xmlns:xsi=<SPAN class="code-quote">&quot;http:<SPAN class="code-comment">//www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
</SPAN>       xmlns:flow=<SPAN class="code-quote">&quot;http:<SPAN class="code-comment">//www.springframework.org/schema/webflow-config&quot;</SPAN>
</SPAN>       xsi:schemaLocation=&quot;
           http:<SPAN class="code-comment">//www.springframework.org/schema/beans
</SPAN>           http:<SPAN class="code-comment">//www.springframework.org/schema/beans/spring-beans-2.0.xsd
</SPAN>           http:<SPAN class="code-comment">//www.springframework.org/schema/webflow-config
</SPAN>           http:<SPAN class="code-comment">//www.springframework.org/schema/webflow-config/spring-webflow-config-1.0.xsd&quot;&gt;
</SPAN>
	&lt;!-- Launches <SPAN class="code-keyword">new</SPAN> flow executions and resumes existing executions. --&gt;	
	&lt;flow:executor id=<SPAN class="code-quote">&quot;flowExecutor&quot;</SPAN> registry-ref=<SPAN class="code-quote">&quot;flowRegistry&quot;</SPAN>&gt;
		&lt;flow:execution-attributes&gt;
		  &lt;flow:alwaysRedirectOnPause value=<SPAN class="code-quote">&quot;<SPAN class="code-keyword">false</SPAN>&quot;</SPAN>/&gt;
		&lt;/flow:execution-attributes&gt;
	&lt;/flow:executor&gt;
	
	&lt;!-- Creates the registry of flow definitions <SPAN class="code-keyword">for</SPAN> <SPAN class="code-keyword">this</SPAN> application --&gt;
	&lt;flow:registry id=<SPAN class="code-quote">&quot;flowRegistry&quot;</SPAN>&gt;
		&lt;flow:location path=<SPAN class="code-quote">&quot;/WEB-INF/flows/**-flow.xml&quot;</SPAN>/&gt;
	&lt;/flow:registry&gt;
	
	&lt;bean id=<SPAN class="code-quote">&quot;struts2FlowAdapter&quot;</SPAN> class=<SPAN class="code-quote">&quot;com.googlecode.struts2webflow.Struts2FlowAdapter&quot;</SPAN>&gt;&lt;/bean&gt;
&lt;/beans&gt;
</PRE>
</DIV></DIV>

<P>The Struts2FlowAdapter allows a Struts 2 action to execute a webflow action-state. The Struts2FlowAdapter uses the id of the action state as the name of Struts 2 action to execute.  The alwaysRedirectOnPause is disabled because whether to redirect or not is easier to control in the Struts 2 configuration files.</P>

<H4><A name="SpringWebflowPlugin-Step3AddSWFinterceptorstoStruts%27sstruts.xmlconfigurationfile"></A>Step 3 - Add SWF interceptors to Struts's struts.xml configuration file</H4>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;interceptors&gt;
	&lt;interceptor name=<SPAN class="code-quote">&quot;sessionFlowExecKey&quot;</SPAN> class=<SPAN class="code-quote">&quot;com.googlecode.struts2webflow.SessionFlowExecKeyInterceptor&quot;</SPAN>/&gt;
	&lt;interceptor name=<SPAN class="code-quote">&quot;annotationflowScope&quot;</SPAN> class=<SPAN class="code-quote">&quot;com.googlecode.struts2webflow.annotations.AnnotationFlowScopeInterceptor&quot;</SPAN>/&gt;
&lt;/interceptors&gt;
</PRE>
</DIV></DIV>

<P>The SessionFlowExecKeyInterceptor puts the flow execution key in the session rather than having it as a hidden field on the form that submitted back. The AnnotationFlowScopeInterceptor uses annotations to bind Struts 2 action variables to and from flow scope. Before an action executes, this interceptor looks for <EM>@FlowIn</EM> annotated properties of the Struts 2 action and populates the these actions from flow scope. After the action has executed, properties annotated with the <EM>@FlowOut</EM> annotation are put back into flow scope.</P>

<H4><A name="SpringWebflowPlugin-Step4ConfiguretheFlowActionsoSpringWebflowscanbeexecuted"></A>Step 4 - Configure the FlowAction so Spring Webflows can be executed</H4>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;action name=<SPAN class="code-quote">&quot;FlowAction&quot;</SPAN> class=<SPAN class="code-quote">&quot;com.googlecode.struts2webflow.FlowAction&quot;</SPAN>&gt;
	&lt;interceptor-ref name=<SPAN class="code-quote">&quot;sessionFlowExecKey&quot;</SPAN> /&gt;
	&lt;interceptor-ref name=<SPAN class="code-quote">&quot;defaultStack&quot;</SPAN> /&gt;
	&lt;param name=<SPAN class="code-quote">&quot;flowId&quot;</SPAN>&gt;rating-flow&lt;/param&gt;
	&lt;result name=<SPAN class="code-quote">&quot;ageEnter&quot;</SPAN> type=<SPAN class="code-quote">&quot;redirect&quot;</SPAN>&gt;
		AgeEnter.action
	&lt;/result&gt;
	&lt;result name=<SPAN class="code-quote">&quot;ageEnterJSP&quot;</SPAN>&gt;/example/enterage.jsp&lt;/result&gt;
	&lt;result name=<SPAN class="code-quote">&quot;calcRate&quot;</SPAN> type=<SPAN class="code-quote">&quot;redirect&quot;</SPAN>&gt;
		CalcRate.action
	&lt;/result&gt;
	&lt;result name=<SPAN class="code-quote">&quot;finish&quot;</SPAN>&gt;/example/finished.jsp&lt;/result&gt;
&lt;/action&gt;
</PRE>
</DIV></DIV>

<P>For each view-state defined in the flow xml definition, there should be a corresponding result entry in the FlowAction definition. (Or a global result for that view-state)</P>

<H4><A name="SpringWebflowPlugin-Step5Accesstheflow"></A>Step 5 - Access the flow</H4>

<P>The flow can now be launched by accessing the FlowAction.</P>


        </DIV>

        
      </DIV>
    </DIV>
    <DIV class="footer">
      Generated by
      <A href="http://www.atlassian.com/confluence/">Atlassian Confluence</A> (Version: 3.2 Build: 1810 Mar 16, 2010)
      <A href="http://could.it/autoexport/">Auto Export Plugin</A> (Version: 1.0.0-dkulp)
    </DIV>
  </BODY>
</HTML>